-- 002-create-books-table.sql
-- Создание таблицы книг
CREATE
    TABLE
        IF NOT EXISTS mentee_power.books(
            id BIGSERIAL PRIMARY KEY,
            title VARCHAR(255) NOT NULL,
            author VARCHAR(255) NOT NULL,
            isbn VARCHAR(50) UNIQUE NOT NULL,
            published_date DATE NOT NULL,
            available BOOLEAN DEFAULT TRUE NOT NULL,
            created_at TIMESTAMP DEFAULT NOW() NOT NULL,
            updated_at TIMESTAMP DEFAULT NOW() NOT NULL
        );

-- Комментарии к таблице

COMMENT ON
TABLE
    mentee_power.books IS 'Каталог книг доступных в системе';

COMMENT ON
COLUMN mentee_power.books.title IS 'Название книги';

COMMENT ON
COLUMN mentee_power.books.author IS 'Автор книги';

COMMENT ON
COLUMN mentee_power.books.isbn IS 'Уникальный идентификатор книги (International Standard Book Number)';

COMMENT ON
COLUMN mentee_power.books.published_date IS 'Дата публикации книги';

COMMENT ON
COLUMN mentee_power.books.available IS 'Флаг доступности книги для выдачи';

-- Генерация 25 тестовых книг
INSERT
    INTO
        mentee_power.books(
            title,
            author,
            isbn,
            published_date,
            available
        )
    VALUES(
        'Война и мир',
        'Лев Толстой',
        '978-5-389-07464-1',
        '1869-01-01',
        TRUE
    ),
    (
        'Преступление и наказание',
        'Фёдор Достоевский',
        '978-5-699-89649-2',
        '1866-01-01',
        TRUE
    ),
    (
        'Мастер и Маргарита',
        'Михаил Булгаков',
        '978-5-17-067842-3',
        '1967-01-01',
        TRUE
    ),
    (
        '1984',
        'Джордж Оруэлл',
        '978-5-17-090630-4',
        '1949-06-08',
        TRUE
    ),
    (
        'Убить пересмешника',
        'Харпер Ли',
        '978-5-17-087895-5',
        '1960-07-11',
        TRUE
    ),
    (
        'Гордость и предубеждение',
        'Джейн Остин',
        '978-5-389-06213-6',
        '1813-01-28',
        TRUE
    ),
    (
        'Тёмные начала',
        'Филип Пулман',
        '978-5-17-080115-7',
        '1995-01-01',
        FALSE
    ),
    (
        'Автостопом по галактике',
        'Дуглас Адамс',
        '978-5-17-080115-8',
        '1979-10-12',
        TRUE
    ),
    (
        'Гарри Поттер и философский камень',
        'Дж. К. Роулинг',
        '978-5-389-07465-8',
        '1997-06-26',
        TRUE
    ),
    (
        'Властелин колец: Братство кольца',
        'Дж. Р. Р. Толкин',
        '978-5-17-080115-9',
        '1954-07-29',
        TRUE
    ),
    (
        'Маленький принц',
        'Антуан де Сент-Экзюпери',
        '978-5-699-89649-3',
        '1943-04-06',
        TRUE
    ),
    (
        'Анна Каренина',
        'Лев Толстой',
        '978-5-389-07464-2',
        '1877-01-01',
        FALSE
    ),
    (
        'Сто лет одиночества',
        'Габриэль Гарсиа Маркес',
        '978-5-699-89649-4',
        '1967-05-30',
        TRUE
    ),
    (
        'Над пропастью во ржи',
        'Джером Сэлинджер',
        '978-5-17-090630-5',
        '1951-07-16',
        TRUE
    ),
    (
        'Великий Гэтсби',
        'Фрэнсис Скотт Фицджеральд',
        '978-5-389-06213-7',
        '1925-04-10',
        TRUE
    ),
    (
        'Моби Дик',
        'Герман Мелвилл',
        '978-5-17-080115-0',
        '1851-10-18',
        FALSE
    ),
    (
        'Алиса в Стране чудес',
        'Льюис Кэрролл',
        '978-5-389-07464-3',
        '1865-11-26',
        TRUE
    ),
    (
        'Дон Кихот',
        'Мигель де Сервантес',
        '978-5-699-89649-5',
        '1605-01-16',
        TRUE
    ),
    (
        'Фауст',
        'Иоганн Вольфганг Гёте',
        '978-5-17-090630-6',
        '1808-01-01',
        TRUE
    ),
    (
        'Божественная комедия',
        'Данте Алигьери',
        '978-5-389-06213-8',
        '1320-01-01',
        FALSE
    ),
    (
        'Грозовой перевал',
        'Эмили Бронте',
        '978-5-17-080115-1',
        '1847-12-01',
        TRUE
    ),
    (
        'О дивный новый мир',
        'Олдос Хаксли',
        '978-5-699-89649-6',
        '1932-01-01',
        TRUE
    ),
    (
        'Лолита',
        'Владимир Набоков',
        '978-5-17-090630-7',
        '1955-09-01',
        TRUE
    ),
    (
        'Атлант расправил плечи',
        'Айн Рэнд',
        '978-5-389-06213-9',
        '1957-10-10',
        FALSE
    ),
    (
        'Тихий Дон',
        'Михаил Шолохов',
        '978-5-17-080115-2',
        '1928-01-01',
        TRUE
    );

-- Обновляем даты created_at и updated_at для всех записей
UPDATE
    mentee_power.books
SET
    created_at = NOW()-(
        random()* INTERVAL '365 days'
    ),
    updated_at = NOW()-(
        random()* INTERVAL '100 days'
    );